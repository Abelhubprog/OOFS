{
  "name": "oof-api",
  "description": "OOF Backend API Service - Solana Wallet Analytics Platform",
  "runtime": "rust",
  "buildCommand": "cargo build --release --bin api",
  "startCommand": "./target/release/api",
  "healthcheckPath": "/health",
  "port": 8080,
  "regions": ["us-west1"],
  "scaling": {
    "minInstances": 1,
    "maxInstances": 5,
    "targetCPU": 70,
    "targetMemory": 80
  },
  "resources": {
    "memory": "2Gi",
    "cpu": "1000m",
    "disk": "10Gi"
  },
  "environmentVariables": {
    "RUST_LOG": "info",
    "RUST_BACKTRACE": "1",
    "API_HOST": "0.0.0.0",
    "API_PORT": "8080",
    "DATABASE_URL": "${DATABASE_URL}",
    "REDIS_URL": "${REDIS_URL}",
    "JWT_SECRET": "${JWT_SECRET}",
    "SOLANA_RPC_URL": "${SOLANA_RPC_URL}",
    "HELIUS_API_KEY": "${HELIUS_API_KEY}",
    "OBJECT_STORE_ENDPOINT": "${OBJECT_STORE_ENDPOINT}",
    "OBJECT_STORE_BUCKET": "${OBJECT_STORE_BUCKET}",
    "OBJECT_STORE_ACCESS_KEY": "${OBJECT_STORE_ACCESS_KEY}",
    "OBJECT_STORE_SECRET_KEY": "${OBJECT_STORE_SECRET_KEY}",
    "PROMETHEUS_ENABLED": "true",
    "METRICS_PORT": "9090",
    "CORS_ALLOWED_ORIGINS": "https://oof.com,https://app.oof.com",
    "RATE_LIMIT_ANONYMOUS": "100",
    "RATE_LIMIT_AUTHENTICATED": "1000",
    "RATE_LIMIT_PREMIUM": "5000",
    "REQUEST_TIMEOUT_SECONDS": "30",
    "MAX_REQUEST_SIZE_MB": "10",
    "CACHE_TTL_SECONDS": "300",
    "WEBHOOK_SECRET": "${WEBHOOK_SECRET}",
    "SENTRY_DSN": "${SENTRY_DSN}",
    "LOG_FORMAT": "json",
    "ENABLE_TRACING": "false",
    "JAEGER_ENDPOINT": "${JAEGER_ENDPOINT}"
  },
  "secrets": [
    "DATABASE_URL",
    "REDIS_URL",
    "JWT_SECRET",
    "HELIUS_API_KEY",
    "OBJECT_STORE_ACCESS_KEY",
    "OBJECT_STORE_SECRET_KEY",
    "WEBHOOK_SECRET",
    "SENTRY_DSN"
  ],
  "build": {
    "dockerfile": "Dockerfile.api",
    "context": ".",
    "buildArgs": {
      "RUST_VERSION": "1.79",
      "BUILD_MODE": "release"
    },
    "ignorePaths": [
      "target/",
      ".git/",
      "*.md",
      "docs/",
      "tests/",
      "scripts/",
      "infra/",
      "frontend/"
    ]
  },
  "monitoring": {
    "metrics": {
      "enabled": true,
      "port": 9090,
      "path": "/metrics"
    },
    "logging": {
      "level": "info",
      "format": "json",
      "retention": "7d"
    },
    "alerts": [
      {
        "name": "High Error Rate",
        "condition": "error_rate > 5%",
        "duration": "5m",
        "severity": "warning"
      },
      {
        "name": "High Response Time",
        "condition": "response_time_p95 > 2s",
        "duration": "5m",
        "severity": "warning"
      },
      {
        "name": "High Memory Usage",
        "condition": "memory_usage > 85%",
        "duration": "5m",
        "severity": "critical"
      },
      {
        "name": "Service Unavailable",
        "condition": "health_check_status != 200",
        "duration": "1m",
        "severity": "critical"
      }
    ]
  },
  "networking": {
    "internal": {
      "allowed": [
        "oof-indexer",
        "oof-workers",
        "oof-detectors",
        "oof-renderer"
      ]
    },
    "external": {
      "domains": [
        "api.oof.com",
        "backend.oof.com"
      ],
      "ssl": {
        "enabled": true,
        "redirect": true
      }
    }
  },
  "deployment": {
    "strategy": "rolling",
    "maxUnavailable": "25%",
    "maxSurge": "25%",
    "terminationGracePeriod": "30s",
    "readinessProbe": {
      "path": "/health",
      "port": 8080,
      "initialDelaySeconds": 30,
      "periodSeconds": 10,
      "timeoutSeconds": 5,
      "failureThreshold": 3
    },
    "livenessProbe": {
      "path": "/health",
      "port": 8080,
      "initialDelaySeconds": 60,
      "periodSeconds": 30,
      "timeoutSeconds": 10,
      "failureThreshold": 3
    }
  },
  "security": {
    "runAsNonRoot": true,
    "readOnlyRootFilesystem": false,
    "allowPrivilegeEscalation": false,
    "capabilities": {
      "drop": ["ALL"]
    },
    "seccomp": {
      "type": "RuntimeDefault"
    }
  },
  "dependencies": {
    "services": [
      "postgresql",
      "redis"
    ],
    "external": [
      "https://price.jup.ag",
      "https://api.helius.xyz"
    ]
  },
  "backups": {
    "database": {
      "enabled": true,
      "schedule": "0 2 * * *",
      "retention": "7d"
    }
  },
  "maintenance": {
    "window": {
      "start": "02:00",
      "end": "04:00",
      "timezone": "UTC",
      "days": ["sunday"]
    }
  },
  "metadata": {
    "version": "1.0.0",
    "team": "oof-backend",
    "environment": "production",
    "tags": ["api", "solana", "analytics", "rust"],
    "contacts": {
      "oncall": "backend-oncall@oof.com",
      "team": "backend-team@oof.com"
    },
    "documentation": "https://docs.oof.com/backend/api",
    "repository": "https://github.com/oof/backend",
    "issues": "https://github.com/oof/backend/issues"
  }
}
